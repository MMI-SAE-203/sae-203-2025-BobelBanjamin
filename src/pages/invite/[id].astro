---
import { getInvite } from "../../../backend.mjs";
import Layout from '../../layouts/Layout.astro';

const { id } = Astro.params;
const invite = await getInvite(id);

console.log("ğŸ” Invite rÃ©cupÃ©rÃ© :", invite);
---

<Layout>
<section class="max-w-5xl mx-auto p-6 bg-[#312345] rounded-lg shadow-lg text-white">
    <h1 class="text-3xl font-bold text-center mb-6">{invite.nom}</h1>

    <!-- âœ… Grille principale : Photo + Infos -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        
        <!-- ğŸ“¸ Photo de l'invitÃ© -->
        <div class="relative">
            {invite.imgUrl ? (
                <img class="w-full max-w-xs rounded-lg shadow-md" 
                     src={invite.imgUrl} 
                     alt={`Photo de ${invite.nom}`} />
            ) : (
                <p class="text-gray-400">âŒ Aucune image disponible</p>
            )}
        </div>

        <!-- ğŸ­ Infos de l'invitÃ© -->
        <div class="space-y-4">
            <p class="text-gray-300"><strong>ğŸ­ RÃ´le :</strong> {invite.role || "Non prÃ©cisÃ©"}</p>
            <p class="text-gray-300"><strong>ğŸ“… AnnÃ©e de naissance :</strong> {invite.annee_naissance || "Non renseignÃ©e"}</p>
            <p class="text-gray-300"><strong>ğŸ† RÃ©compenses :</strong> {invite.recompenses || "Aucune"}</p>
        </div>
    </div>

    <!-- ğŸ¬ Films associÃ©s -->
    {invite.films?.length > 0 && (
        <section class="mt-8">
            <h2 class="text-xl font-semibold">ğŸ¬ Films oÃ¹ il/elle apparaÃ®t</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                {invite.films.map((film) => (
                    <a href={`/film/${film.id}`} class="bg-[#190A35] p-4 rounded-lg shadow-md hover:scale-105 transition">
                        <h3 class="text-lg font-bold">{film.titre_film}</h3>
                        <p class="text-gray-300">ğŸ“… Sortie : {film.sortie}</p>
                    </a>
                ))}
            </div>
        </section>
    )}

    <!-- ğŸ­ ActivitÃ©s associÃ©es -->
    {invite.activites?.length > 0 && (
        <section class="mt-8">
            <h2 class="text-xl font-semibold">ğŸ­ ActivitÃ©s auxquelles il/elle participe</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                {invite.activites.map((activite) => (
                    <a href={`/activite/${activite.id}`} class="bg-[#190A35] p-4 rounded-lg shadow-md hover:scale-105 transition">
                        <h3 class="text-lg font-bold">{activite.nom}</h3>
                        <p class="text-gray-300">ğŸ“… {activite.date_act} - {activite.heure}</p>
                    </a>
                ))}
            </div>
        </section>
    )}
</section>
</Layout>

